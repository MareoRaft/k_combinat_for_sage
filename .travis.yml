# For deployment to github pages, check resource https://docs.travis-ci.com/user/deployment/pages/
# In GitHub settings, go to GitHub Pages section, Source subsection, and select "gh-pages branch" from dropdown.  That option WON'T APPEAR if you don't have a branch called 'gh-pages'.
sudo: required
language: python # python will be pre-installed on server thanks to this
python:
- "2.7"
script:
- pwd
- cd docs
- pwd
- # comment out sage imports (workaround)
- src_files=$(ls ../src/**/* | grep ".py$")
- |
  for file_path in src_files; do
    cat "$file_path" | sed 's/from sage\.all import \*//g' | tee "$file_path"
  done
- make html
- # move html files into place
- mv build/html/* .
- # include .nojekyll (see https://help.github.com/articles/files-that-start-with-an-underscore-are-missing/)
- touch .nojekyll
- ls
deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_API_KEY # You need to create this key (public access token) following the steps in https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/.  Make sure the PAT has the appropriate repo or public_repo access (or both).  Then copy and paste this PAT as an environment variable "GITHUB_API_KEY" in Travis settings for the appropriate repository.
  local_dir: docs
  on:
    branch: master

